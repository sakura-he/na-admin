var d=Object.defineProperty;var k=(e,a,l)=>a in e?d(e,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[a]=l;var h=(e,a,l)=>(k(e,typeof a!="symbol"?a+"":a,l),l);import{r as u}from"./runtime-core.esm-bundler-bda9e85e.js";function f(e){class a{constructor(){h(this,"prefix",e?e+"_":"_")}setCache(t,c,s){let n=`${this.prefix}${t}`.toUpperCase(),C=JSON.stringify({value:c,expire:s&&Date.now()+s});localStorage.setItem(n,C)}getCache(t){let c=`${this.prefix}${t}`.toUpperCase(),s=localStorage.getItem(c);if(!s)return null;let n=JSON.parse(s);return!n.expire||Date.now()<n.expire?n.value:(localStorage.removeItem(c),null)}removeCache(t){let c=`${this.prefix}${t}`.toUpperCase();localStorage.removeItem(c)}}return new a}function I(e){e=e?e.toUpperCase()+"_":"_",console.log("要删除的前缀为:",e);let a=localStorage.length,l=[];for(let t=0;t<a;t++)l.push(localStorage.key(t));console.log(l),l.forEach(t=>{new RegExp(`^${e}[\\d\\D]+`).test(t)&&(console.log("删除的key为:",t),localStorage.removeItem(t))})}var v=(e=>(e.DARK="dark",e.AUTO="auto",e.LIGHT="light",e))(v||{});class b{constructor(){h(this,"callback",{light:{},dark:{}})}}class p extends b{constructor(){super()}addCallback(a,l){let t=Symbol(l+"_callback");return this.callback[l][t]=a,t}removeCallback(a,l){delete this.callback[l][a]}execCallback(a){Object.getOwnPropertySymbols(this.callback[a]).forEach(l=>{typeof this.callback[a][l]=="function"&&this.callback[a][l]()})}}let r=new p,g=f("theme");const m="color_mode",w="ligth_theme_name";let x=g.getCache(m)||"light",M=g.getCache(w)||"default",i=u(x),S=u(M),o=u(!1);function y(){t(i.value),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:c})=>{window.dispatchEvent(new CustomEvent("color-scheme-change",{detail:{matches:c}}))});function e(){!!window.matchMedia("(prefers-color-scheme:dark)").matches?(o.value=!0,r.execCallback("dark")):(o.value=!1,r.execCallback("light"))}function a(c){c.detail.matches?(o.value=!0,r.execCallback("dark")):(o.value=!1,r.execCallback("light"))}function l(){e(),window.addEventListener("color-scheme-change",a)}function t(c){window.removeEventListener("color-scheme-change",o),g.setCache(m,c),i.value=c,c==="auto"?l():c==="light"?(o.value=!1,r.execCallback("light")):(o.value=!0,r.execCallback("dark"))}return{setColorMode:t,value:i,isDarkMode:o,lightTheme:S,themeChangeCallback:r}}export{v as a,f as c,I as r,y as u};
