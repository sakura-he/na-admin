import{P as Z,bG as m,cS as D,A as O,c0 as F,at as H,bg as _,ad as K,x as X,cT as B,bJ as z,cU as $,cV as E,cW as R}from"./install-d8df1eea.js";var j=Math.PI*2,I=Z.CMD,N=["top","right","bottom","left"];function aa(e,s,o,a,v){var f=o.width,n=o.height;switch(e){case"top":a.set(o.x+f/2,o.y-s),v.set(0,-1);break;case"bottom":a.set(o.x+f/2,o.y+n+s),v.set(0,1);break;case"left":a.set(o.x-s,o.y+n/2),v.set(-1,0);break;case"right":a.set(o.x+f+s,o.y+n/2),v.set(1,0);break}}function ra(e,s,o,a,v,f,n,i,h){n-=e,i-=s;var c=Math.sqrt(n*n+i*i);n/=c,i/=c;var r=n*o+e,y=i*o+s;if(Math.abs(a-v)%j<1e-4)return h[0]=r,h[1]=y,c-o;if(f){var M=a;a=R(v),v=R(M)}else a=R(a),v=R(v);a>v&&(v+=j);var t=Math.atan2(i,n);if(t<0&&(t+=j),t>=a&&t<=v||t+j>=a&&t+j<=v)return h[0]=r,h[1]=y,c-o;var x=o*Math.cos(a)+e,b=o*Math.sin(a)+s,p=o*Math.cos(v)+e,S=o*Math.sin(v)+s,k=(x-n)*(x-n)+(b-i)*(b-i),w=(p-n)*(p-n)+(S-i)*(S-i);return k<w?(h[0]=x,h[1]=b,Math.sqrt(k)):(h[0]=p,h[1]=S,Math.sqrt(w))}function g(e,s,o,a,v,f,n,i){var h=v-e,c=f-s,r=o-e,y=a-s,M=Math.sqrt(r*r+y*y);r/=M,y/=M;var t=h*r+c*y,x=t/M;i&&(x=Math.min(Math.max(x,0),1)),x*=M;var b=n[0]=e+x*r,p=n[1]=s+x*y;return Math.sqrt((b-v)*(b-v)+(p-f)*(p-f))}function J(e,s,o,a,v,f,n){o<0&&(e=e+o,o=-o),a<0&&(s=s+a,a=-a);var i=e+o,h=s+a,c=n[0]=Math.min(Math.max(v,e),i),r=n[1]=Math.min(Math.max(f,s),h);return Math.sqrt((c-v)*(c-v)+(r-f)*(r-f))}var C=[];function ea(e,s,o){var a=J(s.x,s.y,s.width,s.height,e.x,e.y,C);return o.set(C[0],C[1]),a}function va(e,s,o){for(var a=0,v=0,f=0,n=0,i,h,c=1/0,r=s.data,y=e.x,M=e.y,t=0;t<r.length;){var x=r[t++];t===1&&(a=r[t],v=r[t+1],f=a,n=v);var b=c;switch(x){case I.M:f=r[t++],n=r[t++],a=f,v=n;break;case I.L:b=g(a,v,r[t],r[t+1],y,M,C,!0),a=r[t++],v=r[t++];break;case I.C:b=E(a,v,r[t++],r[t++],r[t++],r[t++],r[t],r[t+1],y,M,C),a=r[t++],v=r[t++];break;case I.Q:b=$(a,v,r[t++],r[t++],r[t],r[t+1],y,M,C),a=r[t++],v=r[t++];break;case I.A:var p=r[t++],S=r[t++],k=r[t++],w=r[t++],G=r[t++],A=r[t++];t+=1;var Q=!!(1-r[t++]);i=Math.cos(G)*k+p,h=Math.sin(G)*w+S,t<=1&&(f=i,n=h);var V=(y-p)*w/k+p;b=ra(p,S,w,G,G+A,Q,V,M,C),a=Math.cos(G+A)*k+p,v=Math.sin(G+A)*w+S;break;case I.R:f=a=r[t++],n=v=r[t++];var W=r[t++],Y=r[t++];b=J(f,n,W,Y,y,M,C);break;case I.Z:b=g(a,v,f,n,y,M,C,!0),a=f,v=n;break}b<c&&(c=b,o.set(C[0],C[1]))}return c}var L=new m,u=new m,l=new m,P=new m,d=new m;function na(e,s){if(e){var o=e.getTextGuideLine(),a=e.getTextContent();if(a&&o){var v=e.textGuideLineConfig||{},f=[[0,0],[0,0],[0,0]],n=v.candidates||N,i=a.getBoundingRect().clone();i.applyTransform(a.getComputedTransform());var h=1/0,c=v.anchor,r=e.getComputedTransform(),y=r&&K([],r),M=s.get("length2")||0;c&&l.copy(c);for(var t=0;t<n.length;t++){var x=n[t];aa(x,0,i,L,P),m.scaleAndAdd(u,L,P,M),u.transform(y);var b=e.getBoundingRect(),p=c?c.distance(u):e instanceof X?va(u,e.path,l):ea(u,b,l);p<h&&(h=p,u.transform(r),l.transform(r),l.toArray(f[0]),u.toArray(f[1]),L.toArray(f[2]))}oa(f,s.get("minTurnAngle")),o.setShape({points:f})}}}var q=[],T=new m;function oa(e,s){if(s<=180&&s>0){s=s/180*Math.PI,L.fromArray(e[0]),u.fromArray(e[1]),l.fromArray(e[2]),m.sub(P,L,u),m.sub(d,l,u);var o=P.len(),a=d.len();if(!(o<.001||a<.001)){P.scale(1/o),d.scale(1/a);var v=P.dot(d),f=Math.cos(s);if(f<v){var n=g(u.x,u.y,l.x,l.y,L.x,L.y,q,!1);T.fromArray(q),T.scaleAndAdd(d,n/Math.tan(Math.PI-s));var i=l.x!==u.x?(T.x-u.x)/(l.x-u.x):(T.y-u.y)/(l.y-u.y);if(isNaN(i))return;i<0?m.copy(T,u):i>1&&m.copy(T,l),T.toArray(e[1])}}}}function fa(e,s,o){if(o<=180&&o>0){o=o/180*Math.PI,L.fromArray(e[0]),u.fromArray(e[1]),l.fromArray(e[2]),m.sub(P,u,L),m.sub(d,l,u);var a=P.len(),v=d.len();if(!(a<.001||v<.001)){P.scale(1/a),d.scale(1/v);var f=P.dot(s),n=Math.cos(o);if(f<n){var i=g(u.x,u.y,l.x,l.y,L.x,L.y,q,!1);T.fromArray(q);var h=Math.PI/2,c=Math.acos(d.dot(s)),r=h+c-o;if(r>=h)m.copy(T,l);else{T.scaleAndAdd(d,i/Math.tan(Math.PI/2-r));var y=l.x!==u.x?(T.x-u.x)/(l.x-u.x):(T.y-u.y)/(l.y-u.y);if(isNaN(y))return;y<0?m.copy(T,u):y>1&&m.copy(T,l)}T.toArray(e[1])}}}}function U(e,s,o,a){var v=o==="normal",f=v?e:e.ensureState(o);f.ignore=s;var n=a.get("smooth");n&&n===!0&&(n=.3),f.shape=f.shape||{},n>0&&(f.shape.smooth=n);var i=a.getModel("lineStyle").getLineStyle();v?e.useStyle(i):f.style=i}function ta(e,s){var o=s.smooth,a=s.points;if(a)if(e.moveTo(a[0][0],a[0][1]),o>0&&a.length>=3){var v=B(a[0],a[1]),f=B(a[1],a[2]);if(!v||!f){e.lineTo(a[1][0],a[1][1]),e.lineTo(a[2][0],a[2][1]);return}var n=Math.min(v,f)*o,i=z([],a[1],a[0],n/v),h=z([],a[1],a[2],n/f),c=z([],i,h,.5);e.bezierCurveTo(i[0],i[1],i[0],i[1],c[0],c[1]),e.bezierCurveTo(h[0],h[1],h[0],h[1],a[2][0],a[2][1])}else for(var r=1;r<a.length;r++)e.lineTo(a[r][0],a[r][1])}function ia(e,s,o){var a=e.getTextGuideLine(),v=e.getTextContent();if(!v){a&&e.removeTextGuideLine();return}for(var f=s.normal,n=f.get("show"),i=v.ignore,h=0;h<D.length;h++){var c=D[h],r=s[c],y=c==="normal";if(r){var M=r.get("show"),t=y?i:O(v.states[c]&&v.states[c].ignore,i);if(t||!O(M,n)){var x=y?a:a&&a.states[c];x&&(x.ignore=!0);continue}a||(a=new F,e.setTextGuideLine(a),!y&&(i||!n)&&U(a,!0,"normal",s.normal),e.stateProxy&&(a.stateProxy=e.stateProxy)),U(a,!1,c,r)}}if(a){H(a.style,o),a.style.fill=null;var b=f.get("showAbove"),p=e.textGuideLineConfig=e.textGuideLineConfig||{};p.showAbove=b||!1,a.buildPath=ta}}function ha(e,s){s=s||"labelLine";for(var o={normal:e.getModel(s)},a=0;a<_.length;a++){var v=_[a];o[v]=e.getModel([v,s])}return o}export{fa as a,ha as g,oa as l,ia as s,na as u};
