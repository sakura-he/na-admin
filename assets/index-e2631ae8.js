import{T as q,v as I,r as U}from"./runtime-dom.esm-bundler-a8993a42.js";import{h as ve,i as pe,I as me,b as ye,o as he,a as be,c as Ce,g as k}from"./use-popup-manager-465c96d3.js";import{B as we,a as Oe,i as J,_ as ke,h as C,o as Q,m as X,s as ge,g as Be}from"./index-0afa90f8.js";import{C as Se,u as Pe,o as $e}from"./use-teleport-container-b7268e2a.js";import{I as Te}from"./index-c2cfd912.js";import{u as Ee,K as De}from"./keyboard-7347d57e.js";import{e as P,d as ze,t as Ie,c as g,v as Ve,am as Le,A as Ne,h as B,o as i,i as V,w as y,ap as _e,E as L,f as h,q as N,b,n as p,k as m,j as Z,z as je,a as S,C as _,D as j,K as Ae}from"./runtime-core.esm-bundler-a91919e4.js";const Ke=e=>{const o=P(!1),t={overflow:"",width:"",boxSizing:""};return{setOverflowHidden:()=>{if(e.value){const l=e.value;if(!o.value&&l.style.overflow!=="hidden"){const a=ve(l);(a>0||pe(l))&&(t.overflow=l.style.overflow,t.width=l.style.width,t.boxSizing=l.style.boxSizing,l.style.overflow="hidden",l.style.width=`${l.offsetWidth-a}px`,l.style.boxSizing="border-box",o.value=!0)}}},resetOverflow:()=>{if(e.value&&o.value){const l=e.value;l.style.overflow=t.overflow,l.style.width=t.width,l.style.boxSizing=t.boxSizing,o.value=!1}}}};var Fe=Object.defineProperty,x=Object.getOwnPropertySymbols,Me=Object.prototype.hasOwnProperty,We=Object.prototype.propertyIsEnumerable,ee=(e,o,t)=>o in e?Fe(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,Ge=(e,o)=>{for(var t in o||(o={}))Me.call(o,t)&&ee(e,t,o[t]);if(x)for(var t of x(o))We.call(o,t)&&ee(e,t,o[t]);return e};const He=["top","right","bottom","left"],Re=ze({name:"Drawer",components:{ClientOnly:Se,ArcoButton:we,IconHover:me,IconClose:Te},inheritAttrs:!1,props:{visible:{type:Boolean,default:!1},defaultVisible:{type:Boolean,default:!1},placement:{type:String,default:"right",validator:e=>He.includes(e)},title:String,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},closable:{type:Boolean,default:!0},okText:String,cancelText:String,okLoading:{type:Boolean,default:!1},okButtonProps:{type:Object},cancelButtonProps:{type:Object},unmountOnClose:Boolean,width:{type:[Number,String],default:250},height:{type:[Number,String],default:250},popupContainer:{type:[String,Object],default:"body"},drawerStyle:{type:Object},onBeforeOk:{type:Function},onBeforeCancel:{type:Function},escToClose:{type:Boolean,default:!0},renderToBody:{type:Boolean,default:!0},header:{type:Boolean,default:!0},footer:{type:Boolean,default:!0},hideCancel:{type:Boolean,default:!1}},emits:{"update:visible":e=>!0,ok:()=>!0,cancel:()=>!0,open:()=>!0,close:()=>!0},setup(e,{emit:o}){const{popupContainer:t}=Ie(e),f=Oe("drawer"),{t:c}=Ee(),l=P(e.defaultVisible),a=g(()=>{var n;return(n=e.visible)!=null?n:l.value}),s=P(!1),r=g(()=>e.okLoading||s.value),{teleportContainer:T,containerRef:v}=Pe({popupContainer:t,visible:a}),w=P(a.value);let O=!1;const K=n=>{e.escToClose&&n.key===De.ESC&&re()&&D()},F=()=>{e.escToClose&&!O&&(O=!0,he(document.documentElement,"keydown",K))},M=()=>{O&&(O=!1,be(document.documentElement,"keydown",K))},{zIndex:ae,isLastDialog:re}=ye("dialog",{visible:a}),se=g(()=>(v==null?void 0:v.value)===document.body);let E=0;const W=()=>{E++,s.value&&(s.value=!1),l.value=!1,o("update:visible",!1)},ie=async()=>{const n=E,d=await new Promise(async z=>{var R;if(C(e.onBeforeOk)){let u=e.onBeforeOk((Y=!0)=>z(Y));if((Q(u)||!X(u))&&(s.value=!0),Q(u))try{u=(R=await u)!=null?R:!0}catch{u=!1}X(u)&&z(u)}else z(!0)});n===E&&(d?(o("ok"),W()):s.value&&(s.value=!1))},D=()=>{var n;let d=!0;C(e.onBeforeCancel)&&(d=(n=e.onBeforeCancel())!=null?n:!1),d&&(o("cancel"),W())},de=()=>{e.maskClosable&&D()},ue=()=>{a.value&&o("open")},fe=()=>{a.value||(w.value=!1,H(),o("close"))},{setOverflowHidden:G,resetOverflow:H}=Ke(v);Ve(()=>{a.value&&(w.value=!0,G(),F())}),Le(()=>{H(),M()}),Ne(a,n=>{l.value!==n&&(l.value=n),n?(w.value=!0,G(),F()):M()});const ce=g(()=>{var n;const d=Ge({[e.placement]:0},(n=e.drawerStyle)!=null?n:{});return["right","left"].includes(e.placement)?d.width=J(e.width)?`${e.width}px`:e.width:d.height=J(e.height)?`${e.height}px`:e.height,d});return{prefixCls:f,style:ce,t:c,mounted:w,computedVisible:a,mergedOkLoading:r,zIndex:ae,handleOk:ie,handleCancel:D,handleOpen:ue,handleClose:fe,handleMask:de,isFixed:se,teleportContainer:T}}});function Ye(e,o,t,f,c,l){const a=B("icon-close"),s=B("icon-hover"),r=B("arco-button"),T=B("client-only");return i(),V(T,null,{default:y(()=>[(i(),V(_e,{to:e.teleportContainer,disabled:!e.renderToBody},[!e.unmountOnClose||e.computedVisible||e.mounted?L((i(),h("div",N({key:0,class:`${e.prefixCls}-container`,style:e.isFixed?{zIndex:e.zIndex}:{zIndex:"inherit",position:"absolute"}},e.$attrs),[b(q,{name:"fade-drawer",appear:""},{default:y(()=>[e.mask?L((i(),h("div",{key:0,class:p(`${e.prefixCls}-mask`),onClick:o[0]||(o[0]=(...v)=>e.handleMask&&e.handleMask(...v))},null,2)),[[I,e.computedVisible]]):m("v-if",!0)]),_:1}),b(q,{name:`slide-${e.placement}-drawer`,appear:"",onAfterEnter:e.handleOpen,onAfterLeave:e.handleClose},{default:y(()=>[L(Z("div",{class:p(e.prefixCls),style:je(e.style)},[e.header?(i(),h("div",{key:0,class:p(`${e.prefixCls}-header`)},[S(e.$slots,"header",{},()=>[e.$slots.title||e.title?(i(),h("div",{key:0,class:p(`${e.prefixCls}-title`)},[S(e.$slots,"title",{},()=>[_(j(e.title),1)])],2)):m("v-if",!0),e.closable?(i(),h("div",{key:1,tabindex:"-1",role:"button","aria-label":"Close",class:p(`${e.prefixCls}-close-btn`),onClick:o[1]||(o[1]=(...v)=>e.handleCancel&&e.handleCancel(...v))},[b(s,null,{default:y(()=>[b(a)]),_:1})],2)):m("v-if",!0)])],2)):m("v-if",!0),Z("div",{class:p(`${e.prefixCls}-body`)},[S(e.$slots,"default")],2),e.footer?(i(),h("div",{key:1,class:p(`${e.prefixCls}-footer`)},[S(e.$slots,"footer",{},()=>[e.hideCancel?m("v-if",!0):(i(),V(r,N({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:y(()=>[_(j(e.cancelText||e.t("drawer.cancelText")),1)]),_:1},16,["onClick"])),b(r,N({type:"primary",loading:e.mergedOkLoading},e.okButtonProps,{onClick:e.handleOk}),{default:y(()=>[_(j(e.okText||e.t("drawer.okText")),1)]),_:1},16,["loading","onClick"])])],2)):m("v-if",!0)],6),[[I,e.computedVisible]])]),_:3},8,["name","onAfterEnter","onAfterLeave"])],16)),[[I,e.computedVisible||e.mounted]]):m("v-if",!0)],8,["to","disabled"]))]),_:3})}var $=ke(Re,[["render",Ye]]),qe=Object.defineProperty,oe=Object.getOwnPropertySymbols,Ue=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable,te=(e,o,t)=>o in e?qe(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,A=(e,o)=>{for(var t in o||(o={}))Ue.call(o,t)&&te(e,t,o[t]);if(oe)for(var t of oe(o))Je.call(o,t)&&te(e,t,o[t]);return e};const le=(e,o)=>{let t=Ce("drawer");const f=()=>{r.component&&(r.component.props.visible=!1),C(e.onOk)&&e.onOk()},c=()=>{r.component&&(r.component.props.visible=!1),C(e.onCancel)&&e.onCancel()},l=async()=>{await Ae(),t&&(U(null,t),document.body.removeChild(t)),t=null,C(e.onClose)&&e.onClose()},a=()=>{r.component&&(r.component.props.visible=!1)},r=b($,A(A(A({},{visible:!0,renderToBody:!1,unmountOnClose:!0,onOk:f,onCancel:c,onClose:l}),$e(e,["content","title","footer","visible","unmountOnClose","onOk","onCancel","onClose"])),{header:typeof e.header=="boolean"?e.header:void 0,footer:typeof e.footer=="boolean"?e.footer:void 0}),{default:k(e.content),header:typeof e.header!="boolean"?k(e.header):void 0,title:k(e.title),footer:typeof e.footer!="boolean"?k(e.footer):void 0});return(o??ne._context)&&(r.appContext=o??ne._context),U(r,t),document.body.appendChild(t),{close:a}},ne=Object.assign($,{open:le,install:(e,o)=>{ge(e,o);const t=Be(o);e.component(t+$.name,$);const f={open:(c,l=e._context)=>le(c,l)};e.config.globalProperties.$drawer=f},_context:null});export{ne as D};
