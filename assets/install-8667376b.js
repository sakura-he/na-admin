import{d7 as i,$ as y,m as M,k as w,d8 as E,bZ as P,d9 as V,a0 as N,da as O,l as R,db as S,w as T,ar as F,j as G,dc as j,dd as q,de as D,bL as U}from"./install-d8df1eea.js";var _={value:"eq","<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","!=":"ne","<>":"ne"},W=function(){function r(a){var e=this._condVal=R(a)?new RegExp(a):S(a)?a:null;if(e==null){var n="";i(n)}}return r.prototype.evaluate=function(a){var e=typeof a;return R(e)?this._condVal.test(a):T(e)?this._condVal.test(a+""):!1},r}(),x=function(){function r(){}return r.prototype.evaluate=function(){return this.value},r}(),z=function(){function r(){}return r.prototype.evaluate=function(){for(var a=this.children,e=0;e<a.length;e++)if(!a[e].evaluate())return!1;return!0},r}(),B=function(){function r(){}return r.prototype.evaluate=function(){for(var a=this.children,e=0;e<a.length;e++)if(a[e].evaluate())return!0;return!1},r}(),H=function(){function r(){}return r.prototype.evaluate=function(){return!this.child.evaluate()},r}(),J=function(){function r(){}return r.prototype.evaluate=function(){for(var a=!!this.valueParser,e=this.getValue,n=e(this.valueGetterParam),t=a?this.valueParser(n):null,o=0;o<this.subCondList.length;o++)if(!this.subCondList[o].evaluate(a?t:n))return!1;return!0},r}();function I(r,a){if(r===!0||r===!1){var e=new x;return e.value=r,e}var n="";return L(r)||i(n),r.and?b("and",r,a):r.or?b("or",r,a):r.not?K(r,a):X(r,a)}function b(r,a,e){var n=a[r],t="";y(n)||i(t),n.length||i(t);var o=r==="and"?new z:new B;return o.children=M(n,function(m){return I(m,e)}),o.children.length||i(t),o}function K(r,a){var e=r.not,n="";L(e)||i(n);var t=new H;return t.child=I(e,a),t.child||i(n),t}function X(r,a){for(var e="",n=a.prepareGetValue(r),t=[],o=w(r),m=r.parser,l=m?E(m):null,c=0;c<o.length;c++){var d=o[c];if(!(d==="parser"||a.valueGetterAttrMap.get(d))){var v=P(_,d)?_[d]:d,h=r[d],f=l?l(h):h,s=V(v,f)||v==="reg"&&new W(f);s||i(e),t.push(s)}}t.length||i(e);var u=new J;return u.valueGetterParam=n,u.valueParser=l,u.getValue=a.getValue,u.subCondList=t,u}function L(r){return N(r)&&!O(r)}var Y=function(){function r(a,e){this._cond=I(a,e)}return r.prototype.evaluate=function(){return this._cond.evaluate()},r}();function Z(r,a){return new Y(r,a)}var $={type:"echarts:filter",transform:function(r){for(var a=r.upstream,e,n=Z(r.config,{valueGetterAttrMap:F({dimension:!0}),prepareGetValue:function(l){var c="",d=l.dimension;P(l,"dimension")||i(c);var v=a.getDimensionInfo(d);return v||i(c),{dimIdx:v.index}},getValue:function(l){return a.retrieveValueFromItem(e,l.dimIdx)}}),t=[],o=0,m=a.count();o<m;o++)e=a.getRawDataItem(o),n.evaluate()&&t.push(e);return{data:t}}},Q={type:"echarts:sort",transform:function(r){var a=r.upstream,e=r.config,n="",t=U(e);t.length||i(n);var o=[];G(t,function(v){var h=v.dimension,f=v.order,s=v.parser,u=v.incomparable;if(h==null&&i(n),f!=="asc"&&f!=="desc"&&i(n),u&&u!=="min"&&u!=="max"){var p="";i(p)}if(f!=="asc"&&f!=="desc"){var g="";i(g)}var C=a.getDimensionInfo(h);C||i(n);var A=s?E(s):null;s&&!A&&i(n),o.push({dimIdx:C.index,parser:A,comparator:new j(f,u)})});var m=a.sourceFormat;m!==q&&m!==D&&i(n);for(var l=[],c=0,d=a.count();c<d;c++)l.push(a.getRawDataItem(c));return l.sort(function(v,h){for(var f=0;f<o.length;f++){var s=o[f],u=a.retrieveValueFromItem(v,s.dimIdx),p=a.retrieveValueFromItem(h,s.dimIdx);s.parser&&(u=s.parser(u),p=s.parser(p));var g=s.comparator.evaluate(u,p);if(g!==0)return g}return 0}),{data:l}}};function rr(r){r.registerTransform($),r.registerTransform(Q)}export{rr as i};
