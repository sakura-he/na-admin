import{cW as i,aB as L,l as M,z as w,cX as P,A as b,cY as S,aA as V,cZ as N,y as _,c_ as O,bl as T,S as F,e as G,c$ as W,d0 as j,d1 as q,b2 as z}from"./install-32865521.js";var R={value:"eq","<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","!=":"ne","<>":"ne"},B=function(){function r(a){var e=this._condVal=_(a)?new RegExp(a):O(a)?a:null;if(e==null){var n="";i(n)}}return r.prototype.evaluate=function(a){var e=typeof a;return _(e)?this._condVal.test(a):T(e)?this._condVal.test(a+""):!1},r}(),D=function(){function r(){}return r.prototype.evaluate=function(){return this.value},r}(),U=function(){function r(){}return r.prototype.evaluate=function(){for(var a=this.children,e=0;e<a.length;e++)if(!a[e].evaluate())return!1;return!0},r}(),X=function(){function r(){}return r.prototype.evaluate=function(){for(var a=this.children,e=0;e<a.length;e++)if(a[e].evaluate())return!0;return!1},r}(),Y=function(){function r(){}return r.prototype.evaluate=function(){return!this.child.evaluate()},r}(),x=function(){function r(){}return r.prototype.evaluate=function(){for(var a=!!this.valueParser,e=this.getValue,n=e(this.valueGetterParam),t=a?this.valueParser(n):null,o=0;o<this.subCondList.length;o++)if(!this.subCondList[o].evaluate(a?t:n))return!1;return!0},r}();function I(r,a){if(r===!0||r===!1){var e=new D;return e.value=r,e}var n="";return y(r)||i(n),r.and?E("and",r,a):r.or?E("or",r,a):r.not?H(r,a):J(r,a)}function E(r,a,e){var n=a[r],t="";L(n)||i(t),n.length||i(t);var o=r==="and"?new U:new X;return o.children=M(n,function(m){return I(m,e)}),o.children.length||i(t),o}function H(r,a){var e=r.not,n="";y(e)||i(n);var t=new Y;return t.child=I(e,a),t.child||i(n),t}function J(r,a){for(var e="",n=a.prepareGetValue(r),t=[],o=w(r),m=r.parser,l=m?P(m):null,c=0;c<o.length;c++){var d=o[c];if(!(d==="parser"||a.valueGetterAttrMap.get(d))){var v=b(R,d)?R[d]:d,h=r[d],f=l?l(h):h,s=S(v,f)||v==="reg"&&new B(f);s||i(e),t.push(s)}}t.length||i(e);var u=new x;return u.valueGetterParam=n,u.valueParser=l,u.getValue=a.getValue,u.subCondList=t,u}function y(r){return V(r)&&!N(r)}var K=function(){function r(a,e){this._cond=I(a,e)}return r.prototype.evaluate=function(){return this._cond.evaluate()},r}();function Z(r,a){return new K(r,a)}var $={type:"echarts:filter",transform:function(r){for(var a=r.upstream,e,n=Z(r.config,{valueGetterAttrMap:F({dimension:!0}),prepareGetValue:function(l){var c="",d=l.dimension;b(l,"dimension")||i(c);var v=a.getDimensionInfo(d);return v||i(c),{dimIdx:v.index}},getValue:function(l){return a.retrieveValueFromItem(e,l.dimIdx)}}),t=[],o=0,m=a.count();o<m;o++)e=a.getRawDataItem(o),n.evaluate()&&t.push(e);return{data:t}}},Q={type:"echarts:sort",transform:function(r){var a=r.upstream,e=r.config,n="",t=z(e);t.length||i(n);var o=[];G(t,function(v){var h=v.dimension,f=v.order,s=v.parser,u=v.incomparable;if(h==null&&i(n),f!=="asc"&&f!=="desc"&&i(n),u&&u!=="min"&&u!=="max"){var p="";i(p)}if(f!=="asc"&&f!=="desc"){var g="";i(g)}var C=a.getDimensionInfo(h);C||i(n);var A=s?P(s):null;s&&!A&&i(n),o.push({dimIdx:C.index,parser:A,comparator:new W(f,u)})});var m=a.sourceFormat;m!==j&&m!==q&&i(n);for(var l=[],c=0,d=a.count();c<d;c++)l.push(a.getRawDataItem(c));return l.sort(function(v,h){for(var f=0;f<o.length;f++){var s=o[f],u=a.retrieveValueFromItem(v,s.dimIdx),p=a.retrieveValueFromItem(h,s.dimIdx);s.parser&&(u=s.parser(u),p=s.parser(p));var g=s.comparator.evaluate(u,p);if(g!==0)return g}return 0}),{data:l}}};function rr(r){r.registerTransform($),r.registerTransform(Q)}export{rr as i};
